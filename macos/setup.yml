- name: Install homebrew
  become: yes
  shell:
    cmd: /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
    creates: /usr/local/bin/brew

- name: Install homebrew packages
  shell:
    cmd: brew install openjdk@17 wget

- name: Install neovim
  shell:
    cmd: brew install neovim && \
      git clone git@github.com:andreas-ries/nvim.git ~/.config/nvim && \
      nvim --headless "+Lazy! sync" +qa
    creates: "{{ ansible_env.HOME }}/.config/nvim"

- name: Install custom font
  shell:
    cmd: curl -LO https://github.com/ryanoasis/nerd-fonts/releases/download/v2.3.3/DejaVuSansMono.zip && \
      unzip DejaVuSansMono.zip -d ~/Library/Fonts && \
      rm DejaVuSansMono.zip
    creates: "{{ ansible_env.HOME }}/Library/Fonts/DejaVu Sans Mono Bold Nerd Font Complete Mono.ttf"

- name: Update .bash_profile to start zsh
  shell:
    cmd: "mv {{ ansible_env.HOME }}/.bash_profile {{ ansible_env.HOME }}/.bash_profile_bak && ln -f -s {{ ansible_env.HOME }}/dotfiles/.bashrc {{ ansible_env.HOME}}/.bash_profile"
    creates: "{{ ansible_env.HOME }}/.bashrc_bak"
